@using BlazorBlogging.Shared.Models

<div>
    <div style="position: sticky; top: 64px; z-index: 1; background: var(--mud-palette-background);">
        <MudContainer MaxWidth="MaxWidth.Medium" Class="px-0 pt-3 pb-3">
            <div class="d-flex align-center gap-3 mb-3">
                <MudChip T="string" Icon="@Icons.Material.Filled.ArrowBack" Color="Color.Tertiary"
                         Variant="Variant.Outlined" OnClick="OnBack" Style="cursor: pointer;">
                    Back to posts
                </MudChip>
                <div class="d-flex align-center gap-2">
                    <MudText Typo="Typo.caption" Color="Color.Secondary">
                        @Post.CreatedAt.ToString("MMMM dd, yyyy")
                    </MudText>
                    @if (Post.Tags.Any())
                    {
                        <MudText Typo="Typo.caption" Color="Color.Secondary">&middot;</MudText>
                        <MudText Typo="Typo.caption" Color="Color.Secondary">
                            @ReadTime min read
                        </MudText>
                    }
                </div>
            </div>
            <MudText Typo="Typo.h3" Style="font-weight: 700; line-height: 1.25; letter-spacing: -0.01em;">
                @Post.Title
            </MudText>
            <MudDivider Class="mt-3" />
        </MudContainer>
    </div>

    <MudContainer MaxWidth="MaxWidth.Medium" Class="px-0 py-4">
        <BlogContentView Content="@Content" />
    </MudContainer>
</div>

@code {
    [Parameter, EditorRequired] public BlogPostSummary Post { get; set; } = default!;
    [Parameter] public string Content { get; set; } = "";
    [Parameter] public EventCallback OnBack { get; set; }

    private int ReadTime => Math.Max(1, (Content?.Split(' ', StringSplitOptions.RemoveEmptyEntries).Length ?? 0) / 200);
}
